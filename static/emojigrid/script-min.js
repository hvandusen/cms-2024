var gridHtml,entities=[],rows=8,current,selected=[],mouseDown=!1,ERASER="",mode,drag=[],randomBrush=!1,width=12;function num(t){return Math.floor(Math.random()*t)}function getId(t){return parseInt($(t).index())+parseInt($(t).parent().index())*width}function initEditor(){$(".editor .block").mousemove(function(){mouseDown&&(addEntity(randomBrush?randomEmoji():current,getId(this)),1===current.length?$(this).addClass("letter"):$(this).removeClass("letter"))}).mouseenter(function(){$(".editor .block:eq("+getId(this)+")").html(current),$(this).toggleClass("hovering")}).mouseleave(function(){$(".editor .block:eq("+getId(this)+")").html(entities[getId(this)]),$(this).toggleClass("hovering")}).click(function(){addEntity(current,getId(this)),1===current.length?$(this).addClass("letter"):$(this).removeClass("letter")})}function initGrid(){var t="";entities=[];for(var e=0,n=0;n<rows;n++){t+="<span class='line-block'>";for(var i=0;i<width;i++)t+="<span class='block' data-x='"+i+"' data-y='"+n+"'></span>",entities.push(""),e++;t+="</span>"}$(".editor").html(t),initEditor()}function updateGrid(){$(".single-column").html(entities.map(function(t){return"<span class='block'>"+t+"</span>"}).join("")),initEditor()}function attachHandlers(){}function updateCurrent(t){current=t,$("#current").html("current emoji: "+(""===current?"ERASER":current))}function updateRows(t){if(rows<t){for(var e="",n=entities.length,i=0;i<t-rows;i++)for(var o=0;o<width;o++)e+="<span class='block x"+o+" y"+(rows+i)+"'></span>",entities.push(""),n++;$(".editor").html($(".editor").html()+e),initEditor()}t<rows&&(entities=entities.slice(0,entities.length-width),updateGrid()),rows=t}function updateColumns(t){var e=[],n=[];if(width<t){for(var i=0;i<t-width;i++)n.push("");for(var o=0;o<rows;o++)e=e.concat(entities.splice(0,width)).concat(n)}if(t<width)for(var r=0,o=0;o<rows;o++){var s=entities.slice();e=e.concat(s.slice(r,r+t)),console.log("reducing columns. entities: ",e,"counter: ",r,"newCols: ",t),r+=width,console.log(r,"condition: ",r+t,entities.length)}width=t,entities=e,$(".single-column").width(24*width),updateGrid(),initEditor()}function fillWNumbers(){entities=entities.map(function(t,e){return e}),updateGrid()}function randomEmoji(){var t=$(".emoji:eq("+num($(".emoji").length)+")").html();return t.length<2?randomEmoji():t}function addEntity(t,e){entities[e]=t,updateGrid()}function randomFill(){entities=entities.map(function(t,e){return 1<t.length?randomEmoji():""}),updateGrid()}$(".single-column").width(24*width),String.prototype.replaceAll=function(t,e){var n;return this.replace(new RegExp(t,"g"),e)},$("button[name=guides]").click(function(){$(".editor").toggleClass("guides")}),$(".mode").click(function(){mode=$(this).text()}),$("button[name=erase]").click(function(){initGrid()}),$("button[name=eraser]").click(function(){updateCurrent(ERASER),randomBrush=!1}),$("input[name=rows]").change(function(){updateRows($(this).val())}),$("input[name=columns]").change(function(){updateColumns(parseInt($(this).val()))}),$("body").on("mousedown",function(){mouseDown=!0}).on("mouseup",function(){mouseDown=!1,drag=[]}),$(".emoji").click(function(t){updateCurrent($(this).html())}),$(window).keypress(function(t){current=t.key,$(".hovering").html(t.key)}),$(".copy-html").click(function(t){var i="",o=$(".emoji:eq(0)").text();$(".emojizone").html($(".editor.single-column").html()),$(".emojizone span").removeAttr("data-y"),$(".emojizone span").removeAttr("data-x"),$(".emojizone span").removeAttr("data-id"),$(".emojizone span").removeClass("block"),$(".emojizone span").removeClass("class"),$(".emojizone span").map(function(t,e){var n=$(e).text();0!==t&&t%width==0&&(i+="<br>"),1<=n.length?n.charCodeAt(0)<200?i+="<em>"+n+"</em>":i+=n:i+="<span>"+o+"</span>"}),console.log(i),$(".emojizone").html(i),$(".output").text($(".temp").html().replaceAll(' class=""',"")),$(".output").select(),document.execCommand("copy")}),$(".copy-text1").click(function(t){$(".output").text($(".editor.single-column").text()),$(".output").select(),document.execCommand("copy")}),$(".random-fill").click(function(t){randomFill()}),$(".random-brush").click(function(t){randomBrush=!randomBrush}),$(".copy-text2").click(function(t){$(".output").text($(".editor.double-column").text()),$(".output").select(),document.execCommand("copy")}),initGrid(),updateCurrent($(".emoji:eq("+num($(".emoji").length)+")").html());